# AI 助手与自动更新

## AI 助手（悬浮球）

- 可见性：设置中“显示悬浮球”开关（默认开启）。`src/renderer/src/store/Settings.ts:24-33`、`src/renderer/src/store/Settings.ts:82-86`。
- 拖拽与吸边：支持窗口内拖拽，松开后自动吸附左右边并半隐藏。位置持久化在本地存储。
  - 拖拽与边界：`src/renderer/src/components/AI/FloatBall.vue:78-147`、`src/renderer/src/components/AI/FloatBall.vue:334-371`。
  - 半隐藏与吸边样式：`src/renderer/src/components/AI/FloatBall.vue:548-555`。
- 使用前置条件：需配置 DeepSeek API Key；未配置时发送时给出提示。
  - 校验与提示：`src/renderer/src/components/AI/FloatBall.vue:149-163`。
- 流式回答：输入问题后通过流式接口接收片段，实时渲染 Markdown（已净化）。
  - 流式事件：`src/preload/index.ts:55-72`、发送流式请求：`src/preload/index.ts:57-59`、事件监听与更新：`src/renderer/src/components/AI/FloatBall.vue:237-290`。

## 自动更新

- 检查更新：触发检查并显示“有更新/无更新”通知或更新说明弹窗。
- 下载进度：展示实时百分比、已传输/总大小，下载完成后提示重启安装。
- 接口与事件：
  - 预加载自动更新 API 与事件：`src/preload/index.ts:128-167`。
  - 渲染层服务：`src/renderer/src/services/autoUpdateService.ts:51-81`（监听各事件）、`src/renderer/src/services/autoUpdateService.ts:91-131`（检查/下载/安装）。
  - 进度通知与完成对话框：`src/renderer/src/services/autoUpdateService.ts:186-215`。

