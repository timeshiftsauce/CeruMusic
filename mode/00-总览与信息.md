# 澜音 CeruMusic 使用总览与软件信息

- 目标：为澜音 CeruMusic 提供覆盖完整、术语严谨的使用与信息说明，作为大模型知识库数据源。
- 核心特性：插件化音源框架、跨平台桌面端、播放列表管理、桌面歌词、系统媒体控制（SMTC）、本地音乐索引、下载与标签写入、AI 助手、自动更新。

## 软件架构

- 主进程：Electron 应用启动、窗口管理、系统托盘、IPC 通信、自动更新、桌面歌词窗口。
- 预加载层：统一注入安全 API（`window.api`）供渲染层调用，包括插件、音乐服务、目录设置、歌单管理、AI、自动更新、本地音乐等。
  - 插件管理 API：`src/preload/index.ts:41-53`
- 渲染层：Vue 3 + Pinia + TDesign，提供搜索、播放、播放列表、设置、桌面歌词控制、AI 浮球等。
  - 系统媒体控制（Media Session）：`src/renderer/src/utils/audio/useSmtc.ts:87`
  - 桌面歌词窗口创建：`src/main/windows/lyric-window.ts:28`

## 运行环境与平台

- 操作系统：Windows、macOS、Linux（Electron 打包目标）。
- 运行时：Node.js、Chromium（Electron）。
- 前端框架：Vue 3、Pinia、TDesign、Naive UI（部分组件）。
- 构建与开发：`yarn dev` 启动，`yarn build:*` 各平台打包（见 `package.json`）。

## 功能清单

- 插件化音源生态：支持多来源数据插件（澜音格式 CR、洛雪格式 LX），在线/本地导入，选择当前使用插件与音源/音质。
- 搜索与发现：搜索单曲与歌单，分页加载，歌单详情与替换播放列表。
- 播放控制：全局音频组件、系统媒体控制（SMTC）、播放/暂停/上一首/下一首、音量、进度。
- 播放列表：添加到首位并播放、添加到末尾、替换整表、持久化到本地存储、导出/导入/分享。
- 下载与标签：选择音质下载，写入标题/艺术家/专辑/封面/歌词标签，可配置写入项。
- 桌面歌词：透明置顶窗口、锁定穿透、拖拽移动、样式配置（字号、主色、阴影）。
- 本地音乐：目录索引、播放本地文件、写入标签、按 ID 获取本地 URL。
- 自动更新：检查更新、下载进度提示、下载完成后重启安装。
- AI 助手：可拖拽吸边的悬浮球，流式回答，需配置 DeepSeek API Key。

## 数据与隐私

- 本地存储：用户设置与播放列表保存在本地（`localStorage`）。
- 目录设置：缓存/下载目录由用户选择并保存在本地配置（主进程持久化）。
- 网络访问：音乐数据、封面与歌词由插件或公开接口提供，合规责任由用户与插件作者承担。
- 云端：不内置云备份；请用户自行备份导出的播放列表与设置。

## 术语与约定

- 插件（Plugin）：提供特定音源的搜索、歌词、封面、播放链接、下载能力的扩展。
- 音源（Source）：具体平台或站点的数据来源（如 `wy`、`tx`、`kg` 等）。
- 音质（Quality）：按从低到高的等级（如 `128k`、`192k`、`320k`、`flac`、`flac24bit`、`hires` 等）。
- 播放列表（Playlist）：当前播放队列（本地持久化），支持导出/导入与分享。
- 歌单（SongList）：平台侧的歌单实体，可搜索查看并批量加入或替换当前播放列表。

